<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Core functions · PressureDrop.jl</title><link href="https://cdnjs.cloudflare.com/ajax/libs/normalize/4.2.0/normalize.min.css" rel="stylesheet" type="text/css"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.2.0/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link href="../assets/documenter.css" rel="stylesheet" type="text/css"/></head><body><nav class="toc"><h1>PressureDrop.jl</h1><select id="version-selector" onChange="window.location.href=this.value" style="visibility: hidden"></select><form class="search" id="search-form" action="../search/"><input id="search-query" name="q" type="text" placeholder="Search docs"/></form><ul><li><a class="toctext" href="../">Overview</a></li><li class="current"><a class="toctext" href>Core functions</a><ul class="internal"><li><a class="toctext" href="#Creating-and-updating-models-1">Creating and updating models</a></li><li><a class="toctext" href="#Pressure-and-temperature-calculations-1">Pressure &amp; temperature calculations</a></li><li><a class="toctext" href="#bulkcalcs-1">Bulk calculations</a></li><li><a class="toctext" href="#Types-and-Functions-1">Types and Functions</a></li></ul></li><li><a class="toctext" href="../plotting/">Plotting</a></li><li><a class="toctext" href="../correlations/">Pressure &amp; temperature correlations</a></li><li><a class="toctext" href="../pvt/">PVT properties</a></li><li><a class="toctext" href="../valves/">Valve calculations</a></li><li><a class="toctext" href="../utilities/">Utilities</a></li><li><a class="toctext" href="../extending/">Extending</a></li><li><a class="toctext" href="../similartools/">Similar tools</a></li></ul></nav><article id="docs"><header><nav><ul><li><a href>Core functions</a></li></ul><a class="edit-page" href="https://github.com/jnoynaert/PressureDrop.jl/blob/master/docs/src/core.md"><span class="fa"></span> Edit on GitHub</a></nav><hr/><div id="topbar"><span>Core functions</span><a class="fa fa-bars" href="#"></a></div></header><h1><a class="nav-anchor" id="Core-functionality-1" href="#Core-functionality-1">Core functionality</a></h1><ul><li><a href="#Core-functionality-1">Core functionality</a></li><ul><li><a href="#Creating-and-updating-models-1">Creating and updating models</a></li><ul><li><a href="#Wellbores-1">Wellbores</a></li><li><a href="#Valve-designs-1">Valve designs</a></li><li><a href="#Models-and-parameter-sets-1">Models &amp; parameter sets</a></li></ul><li><a href="#Pressure-and-temperature-calculations-1">Pressure &amp; temperature calculations</a></li><ul><li><a href="#Pressure-traverses-and-temperature-profiles-1">Pressure traverses &amp; temperature profiles</a></li><li><a href="#Gas-lift-analysis-1">Gas lift analysis</a></li></ul><li><a href="#bulkcalcs-1">Bulk calculations</a></li><li><a href="#Types-and-Functions-1">Types and Functions</a></li><ul><li><a href="#Types-1">Types</a></li><li><a href="#Functions-1">Functions</a></li></ul></ul></ul><div></div><h2><a class="nav-anchor" id="Creating-and-updating-models-1" href="#Creating-and-updating-models-1">Creating and updating models</a></h2><p>Model definitions are created and stored as <a href="#PressureDrop.WellModel"><code>WellModel</code></a> objects. Although all of the functionality of this package is exposed as pure functions, mutating and copying <code>WellModel</code>s is a much easier way to track and iterate on parameter sets.</p><h3><a class="nav-anchor" id="Wellbores-1" href="#Wellbores-1">Wellbores</a></h3><p>The key component required for the pressure drop calculations is a <a href="#PressureDrop.Wellbore"><code>Wellbore</code></a> object that defines the flow path in terms of directional survey points (measured depth, inclination, and true vertical depth) and tubular inner diameter.</p><p><code>Wellbore</code> objects can be constructed from arrays, or from CSV files with <code>read_survey</code>, which includes some optional convenience arguments to change delimiters, skip lines, or truncate the survey. Tubing IDs do not have to be uniform and can be specified segment to segment.</p><pre><code class="language-julia">examplewell = read_survey(path = surveyfilepath, id = 2.441, maxdepth = 6500) #an outlet point at 0 MD is added if not present</code></pre><pre><code class="language-none">Wellbore with 67 points.
Ends at 6459.0&#39; MD / 6405.05&#39; TVD.
Max inclination 13.4°. Average ID 2.441 in.</code></pre><p>The expected format for a survey file is a comma separated file with measured depth, inclination from vertical, true vertical depth, and optionally, flowpath inner diameter:</p><div></div><pre><code class="language-none">╭───────┬─────┬────────┬───────╮
│    MD │ Inc │    TVD │    ID │
│    ft │   ° │     ft │    in │
├───────┼─────┼────────┼───────┤
│   0.0 │ 0.0 │    0.0 │ 2.441 │
│ 460.0 │ 0.0 │  460.0 │ 2.441 │
│ 552.0 │ 1.5 │ 551.94 │ 2.441 │
│ 644.0 │ 1.5 │ 643.91 │ 1.995 │
│     ⋮ │   ⋮ │      ⋮ │     ⋮ │
╰───────┴─────┴────────┴───────╯</code></pre><p>See an example survey input file <a href="https://github.com/jnoynaert/PressureDrop.jl/blob/master/test/testdata/Sawgrass_9_32/Test_survey_Sawgrass_9.csv">here</a>.</p><p>By default, <code>read_survey</code> will skip a single header line and take a single ID for the entire flowpath.</p><h3><a class="nav-anchor" id="Valve-designs-1" href="#Valve-designs-1">Valve designs</a></h3><p><code>GasliftValves</code> objects define the valve strings in terms of measured run depth, test rack opening pressure, R value (ratio of the area of the port to the area of the bellows), and port size.</p><pre><code class="language-julia">examplevalves = read_valves(path = valvefilepath)</code></pre><pre><code class="language-none">Valve design with 4 valves and bottom valve at 3395.0&#39; MD.</code></pre><p>These can also be constructed directly or from CSV files. The expect format is valves by measured depth, test rack opening pressure @ 60° F in psig, the R ratio of the valve (effective area of the port to the area of the bellows), and the port size in 64ths inches:</p><div></div><pre><code class="language-none">╭────────┬────────┬───────┬──────────╮
│     MD │   PTRO │     R │     Port │
│     ft │   psig │ Ap/Ab │ 64ths in │
├────────┼────────┼───────┼──────────┤
│ 1813.0 │ 1005.0 │ 0.073 │     16.0 │
│ 2375.0 │  990.0 │ 0.073 │     16.0 │
│ 2885.0 │  975.0 │ 0.073 │     16.0 │
│ 3395.0 │    0.0 │   0.0 │     14.0 │
│      ⋮ │      ⋮ │     ⋮ │        ⋮ │
╰────────┴────────┴───────┴──────────╯</code></pre><p>See an example valve input file <a href="https://github.com/jnoynaert/PressureDrop.jl/blob/master/test/testdata/valvedata_wrappers_1.csv">here</a>.</p><p>By default, <code>read_valves</code> will skip a single header line, and orifice valves are indicated by an R-value of 0.</p><h3><a class="nav-anchor" id="Models-and-parameter-sets-1" href="#Models-and-parameter-sets-1">Models &amp; parameter sets</a></h3><p><code>WellModel</code>s do not have to be completely specified, but require defining the minimum fields for a simple pressure drop. In general, sensible defaults are selected for PVT functions. See the <a href="@ref WellModel">documentation</a> for a list of optional fields.</p><p>Note that defining a valve string is optional if all that is desired is a normal pressure drop or temperature calculation.</p><pre><code class="language-julia">model = WellModel(wellbore = examplewell, roughness = 0.00065,
                  valves = examplevalves,
                  pressurecorrelation = BeggsAndBrill,
                  WHP = 200, #wellhead pressure, psig
                  CHP = 1050, #casing pressure, psig
                  dp_est = 25, #estimated ΔP by segment. Not critical
                  temperature_method = &quot;Shiu&quot;, #temperatures can be calculated or provided directly as a array
                  BHT = 160, geothermal_gradient = 0.9,  #°F, °F/100&#39;
                  q_o = 100, q_w = 500, #bpd
                  GLR = 2500, naturalGLR = 400, #scf/bbl
                  APIoil = 35, sg_water = 1.05, sg_gas = 0.65);</code></pre><pre><code class="language-none">Well model: 
wellbore : Wellbore with 67 points.
Ends at 6459.0&#39; MD / 6405.05&#39; TVD.
Max inclination 13.4°. Average ID 2.441 in.
roughness : 0.00065
valves : Valve design with 4 valves and bottom valve at 3395.0&#39; MD.
temperatureprofile : missing
temperature_method : Shiu
WHT : missing
geothermal_gradient : 0.9
BHT : 160
casing_temp_factor : 0.85
pressurecorrelation : PressureDrop.BeggsAndBrill
outlet_referenced : true
WHP : 200
CHP : 1050
dp_est : 25
dp_est_inj : 2.5
error_tolerance : 0.1
error_tolerance_inj : 0.05
q_o : 100
q_w : 500
GLR : 2500
injection_point : missing
naturalGLR : 400
APIoil : 35
sg_water : 1.05
sg_gas : 0.65
sg_gas_inj : 0.65
molFracCO2 : 0.0
molFracH2S : 0.0
molFracCO2_inj : 0.0
molFracH2S_inj : 0.0
pseudocrit_pressure_correlation : PressureDrop.HankinsonWithWichertPseudoCriticalPressure
pseudocrit_temp_correlation : PressureDrop.HankinsonWithWichertPseudoCriticalTemp
Z_correlation : PressureDrop.KareemEtAlZFactor
gas_viscosity_correlation : PressureDrop.LeeGasViscosity
solutionGORcorrelation : PressureDrop.StandingSolutionGOR
bubblepoint : PressureDrop.StandingBubblePoint
oilVolumeFactor_correlation : PressureDrop.StandingOilVolumeFactor
waterVolumeFactor_correlation : PressureDrop.GouldWaterVolumeFactor
dead_oil_viscosity_correlation : PressureDrop.GlasoDeadOilViscosity
live_oil_viscosity_correlation : PressureDrop.ChewAndConnallySaturatedOilViscosity
frictionfactor : PressureDrop.SerghideFrictionFactor
</code></pre><p>Printing a WellModel will display all of its defined and undefined fields.</p><div class="admonition note"><div class="admonition-title">Note</div><div class="admonition-text"><p>An important aspect of model definitions is that they include the temperature profile. Passing a model object to a wrapper function that calculates both pressure and temperature will mutate the temperature profile associate with the model.</p></div></div><h2><a class="nav-anchor" id="Pressure-and-temperature-calculations-1" href="#Pressure-and-temperature-calculations-1">Pressure &amp; temperature calculations</a></h2><h3><a class="nav-anchor" id="Pressure-traverses-and-temperature-profiles-1" href="#Pressure-traverses-and-temperature-profiles-1">Pressure traverses &amp; temperature profiles</a></h3><p>Pressure and temperature profiles can be generated from a <code>WellModel</code> using <a href="#PressureDrop.pressure_and_temp!"><code>pressure_and_temp!</code></a> (for tubing calculations only) or <a href="#PressureDrop.pressures_and_temp!"><code>pressures_and_temp!</code></a> (to include casing calculations).</p><pre><code class="language-julia">tubing_pressures = pressure_and_temp!(model); #note that this updates temperature in the .temperatureprofile field of the WellModel</code></pre><pre><code class="language-none">67-element Array{Float64,1}:
 200.0             
 245.37572407761115
 254.30964761005504
 263.21807061167675
 272.10717290933127
 280.98313730062927
 289.85305595952843
 298.6248104048196 
 308.28907910882697
 318.1001426268174 
   ⋮               
 859.0982954570584 
 872.1021884338534 
 885.0572186756406 
 897.9579845330136 
 911.0831457681081 
 924.4378535697161 
 937.5908840507635 
 950.9661391150678 
 964.4295621365758 </code></pre><p>Several <a href="../plotting/#Plotting-1">plotting functions</a> are available to visualize the outputs.</p><pre><code class="language-julia">using Gadfly #necessary to load plotting functions

plot_pressure(model, tubing_pressures, &quot;Tubing Pressure Drop&quot;)</code></pre><p><img src="../plot-pressure-core.svg" alt/></p><p>Pressure traverses for just tubing or just casing, utilizing an existing temperature profile, can be calculated using <a href="#PressureDrop.traverse_topdown"><code>traverse_topdown</code></a> or <a href="#PressureDrop.casing_traverse_topdown"><code>casing_traverse_topdown</code></a>.</p><h3><a class="nav-anchor" id="Gas-lift-analysis-1" href="#Gas-lift-analysis-1">Gas lift analysis</a></h3><p>The <a href="#PressureDrop.gaslift_model!"><code>gaslift_model!</code></a> function will calculate the pressure and temperature profiles, most likely operating point (assuming single-point injection), and opening and closing pressures of the valves.</p><pre><code class="language-julia">tubing_pressures, casing_pressures, valvedata = gaslift_model!(model, find_injectionpoint = true,
               dp_min = 100) #required minimum ΔP at depth to consider as an operating valve

plot_gaslift(model, tubing_pressures, casing_pressures, valvedata, &quot;Gas Lift Analysis Plot&quot;)</code></pre><pre><code class="language-none">[ Info: Inferred injection depth @ 1813.0&#39; MD.
┌ Info: Specified injection point at 1813.0&#39; MD not explicitly included in wellbore. Using 1852.0&#39; MD as an approximate match.
└ Use the Wellbore constructor with a set of gas lift valves to add precise injection points.</code></pre><p><img src="../plot-gl-core.svg" alt/></p><p>The results of the valve calculations can be printed as a table:</p><pre><code class="language-julia">valve_table(valvedata)</code></pre><pre><code class="language-none">╭─────┬──────┬──────┬──────┬──────┬───────┬───────┬──────┬──────┬──────┬──────┬──────┬──────┬──────┬──────┬───────┬───────┬───────╮
│ GLV │   MD │  TVD │  PSO │  PSC │  Port │     R │ PPEF │ PTRO │   TP │   CP │  PVO │  PVC │ T_td │ T_cd │   Q_o │ Q_1.5 │   Q_1 │
│     │   ft │   ft │ psig │ psig │ 64ths │       │    % │ psig │ psig │ psig │ psig │ psig │   °F │   °F │ mcf/d │ mcf/d │ mcf/d │
├─────┼──────┼──────┼──────┼──────┼───────┼───────┼──────┼──────┼──────┼──────┼──────┼──────┼──────┼──────┼───────┼───────┼───────┤
│   4 │ 1813 │ 1806 │ 1055 │ 1002 │    16 │ 0.073 │    8 │ 1005 │  384 │ 1100 │ 1104 │ 1052 │  132 │  112 │  1480 │  1125 │   888 │
│   3 │ 2375 │ 2357 │ 1023 │  979 │    16 │ 0.073 │    8 │  990 │  497 │ 1115 │ 1088 │ 1045 │  136 │  116 │  1493 │  1135 │   896 │
│   2 │ 2885 │ 2856 │  990 │  957 │    16 │ 0.073 │    8 │  975 │  611 │ 1129 │ 1069 │ 1036 │  141 │  119 │  1506 │  1144 │   903 │
│   1 │ 3395 │ 3355 │  957 │  934 │    16 │ 0.073 │    8 │  960 │  733 │ 1143 │ 1050 │ 1027 │  145 │  123 │  1486 │  1129 │   892 │
╰─────┴──────┴──────┴──────┴──────┴───────┴───────┴──────┴──────┴──────┴──────┴──────┴──────┴──────┴──────┴───────┴───────┴───────╯</code></pre><p>The data for a valve table can be calculated directly using <a href="../valves/#PressureDrop.valve_calcs-Tuple{}"><code>valve_calcs</code></a>, which will interpolate pressures and temperatures at depth from known producing P/T profiles.</p><h2><a class="nav-anchor" id="bulkcalcs-1" href="#bulkcalcs-1">Bulk calculations</a></h2><p>Pressure drops can be calculated in bulk, either by passing model arguments to functions directly, or by mutating or copying model objects.</p><pre><code class="language-julia">nominal_rate(D_sei, b) = ((1-D_sei)^(-b) - 1)/b #secant decline rates to nominal rates, b ≠ 0
hyperbolic_rate(q_i, b, D_sei, t) = q_i / (1 + b * nominal_rate(D_sei, b) * t)^(1/b) #spot rate from a hyperbolic decline for t in years

# generate test data
q_i = 3000
b = 1.2
decline = 0.85
timesteps = range(0, stop = 2, step = 1/365)
declinedata = [hyperbolic_rate(q_i, b, decline, time) for time in timesteps]
noise = [randn() .* 15 for sample in timesteps]
testdata = max.(declinedata .+ noise, 0)

# check results
days = timesteps .* 365
plot(x = days, y = testdata, Geom.path,
     Guide.xlabel(&quot;Time (days)&quot;),
     Guide.ylabel(&quot;Total Fluid (bpd)&quot;),
     Scale.y_continuous(format = :plain, minvalue = 0))</code></pre><p><img src="../test-data.svg" alt/></p><pre><code class="language-julia"># set up and calculate pressure data
examplewell = read_survey(path = surveyfilepath, id = 2.441, maxdepth = 6500)

function timestep_pressure(rate, temp, watercut, GLR)
    temps = linear_wellboretemp(WHT = temp, BHT = 165, wellbore = examplewell)

    return traverse_topdown(wellbore = examplewell, roughness = 0.0065, temperatureprofile = temps,
                     pressurecorrelation = BeggsAndBrill, dp_est = 25, error_tolerance = 0.1,
                     q_o = rate * (1 - watercut), q_w = rate * watercut, GLR = GLR,
                     APIoil = 36, sg_water = 1.05, sg_gas = 0.65,
                     WHP = 120)[end]
end

wellhead_temps = range(125, stop = 85, length = 731)
watercuts = range(1, stop = 0.5, length = 731)
GLR = range(0, stop = 5000, length = 731)

pressures = timestep_pressure.(testdata, wellhead_temps, watercuts, GLR)

# examine outputs
plot(x = days, y = pressures, Geom.path, Theme(default_color = &quot;purple&quot;),
     Guide.xlabel(&quot;Time (days)&quot;),
     Guide.ylabel(&quot;Flowing Pressure (psig)&quot;),
     Scale.y_continuous(format = :plain, minvalue = 0),
     Guide.title(&quot;FBHP Over Time&quot;))</code></pre><p><img src="../pressure-data.svg" alt/></p><h2><a class="nav-anchor" id="Types-and-Functions-1" href="#Types-and-Functions-1">Types and Functions</a></h2><ul><li>Types<ul><li><a href="#PressureDrop.Wellbore"><code>Wellbore</code></a></li><li><a href="#PressureDrop.GasliftValves"><code>GasliftValves</code></a></li><li><a href="#PressureDrop.WellModel"><code>WellModel</code></a></li></ul></li><li>Functions   <a href="#PressureDrop.traverse_topdown"><code>traverse_topdown</code></a>   <a href="#PressureDrop.casing_traverse_topdown"><code>casing_traverse_topdown</code></a>   <a href="#PressureDrop.pressure_and_temp!"><code>pressure_and_temp!</code></a>   <a href="#PressureDrop.pressures_and_temp!"><code>pressures_and_temp!</code></a>   <a href="#PressureDrop.gaslift_model!"><code>gaslift_model!</code></a></li></ul><h3><a class="nav-anchor" id="Types-1" href="#Types-1">Types</a></h3><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="PressureDrop.Wellbore" href="#PressureDrop.Wellbore"><code>PressureDrop.Wellbore</code></a> — <span class="docstring-category">Type</span>.</div><div><div><p><code>Wellbore</code>: type to define a flow path as an input for pressure drop calculations</p><p>See <code>read_survey</code> for helper method to create a Wellbore object from deviation survey files.</p><p><strong>Fields</strong></p><ul><li><code>md::Array{Float64, 1}</code>: measured depth for each segment in feet</li><li><code>inc::Array{Float64, 1}</code>: inclination from vertical for each segment in degrees, e.g. true vertical = 0°</li><li><code>tvd::Array{Float64, 1}</code>: true vertical depth for each segment in feet</li><li><code>id::Array{Float64, 1}</code>: inner diameter for each pip segment in inches</li></ul><p><strong>Constructors</strong></p><p>By default, negative depths are disallowed, and a 0 MD / 0 TVD point is added if not present, to allow graceful handling of outlet pressure definitions. To bypass both the error checking and convenience feature, pass <code>true</code> as the final argument to the constructor.</p><p><code>Wellbore(md, inc, tvd, id::Array{Float64, 1}, allow_negatives = false)</code>: defines a new Wellbore object from a survey with inner diameter defined for each segment. Lengths of each input array must be equal.</p><p><code>Wellbore(md, inc, tvd, id::Float64, allow_negatives = false)</code>: defines a new Wellbore object with a uniform ID along the entire flow path.</p><p><code>Wellbore(md, inc, tvd, id, valves::GasliftValves, allow_negatives = false)</code>: defines a new Wellbore object and adds interpolated survey points for each gas lift valve.</p></div></div><a class="source-link" target="_blank" href="https://github.com/jnoynaert/PressureDrop.jl/blob/7fd8bf2c10af78a06320ebbb189e9e2a903cb140/src/types.jl#L40-L60">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="PressureDrop.GasliftValves" href="#PressureDrop.GasliftValves"><code>PressureDrop.GasliftValves</code></a> — <span class="docstring-category">Type</span>.</div><div><div><p><code>GasliftValves</code>: a type to define a string of gas lift valves for valve &amp; pressure calculations.</p><p>Constructor: <code>GasliftValves(md::Array, PTRO::Array, R::Array, port::Array)</code></p><p>Port sizes must be in integer increments of 64ths inches.</p><p>Indicate orifice valves with an R-value and PTRO of 0.</p></div></div><a class="source-link" target="_blank" href="https://github.com/jnoynaert/PressureDrop.jl/blob/7fd8bf2c10af78a06320ebbb189e9e2a903cb140/src/types.jl#L1-L9">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="PressureDrop.WellModel" href="#PressureDrop.WellModel"><code>PressureDrop.WellModel</code></a> — <span class="docstring-category">Type</span>.</div><div><div><p><code>WellModel</code>: Makes it easier to iterate well models</p><p><code>pressure_and_temp(;model::WellModel)</code></p><p>Develop pressure traverse in psia and temperature profile in °F from wellhead down to datum for a WellModel object. Requires the following fields to be defined in the model:</p><p>Returns a pressure profile as an Array{Float64,1} and a temperature profile as an Array{Float64,1}, referenced to the measured depths in the original Wellbore object.</p><p>Pressure correlation functions available:</p><ul><li><code>BeggsAndBrill</code> with Payne correction factors</li><li><code>HagedornAndBrown</code> with Griffith and Wallis bubble flow correction</li></ul><p><strong>Required</strong></p><ul><li><code>well::Wellbore</code>: Wellbore object that defines segmentation/mesh, with md, tvd, inclination, and hydraulic diameter</li><li><code>roughness</code>: pipe wall roughness in inches</li><li><code>temperature_method = &quot;linear&quot;</code>: temperature method to use; &quot;Shiu&quot; for Ramey method with Shiu relaxation factor, &quot;linear&quot; for linear interpolation</li><li><code>WHT = missing</code>: wellhead temperature in °F; required for <code>temperature_method = &quot;linear&quot;</code></li><li><code>geothermal_gradient = missing</code>: geothermal gradient in °F per 100 ft; required for <code>temperature_method = &quot;Shiu&quot;</code></li><li><code>BHT</code> = bottomhole temperature in °F</li><li><code>WHP</code>: absolute outlet pressure (wellhead pressure) in <strong>psig</strong></li><li><code>dp_est</code>: estimated starting pressure differential (in psi) to use for all segments–impacts convergence time</li><li><code>q_o</code>: oil rate in stocktank barrels/day</li><li><code>q_w</code>: water rate in stb/d</li><li><code>GLR</code>: <strong>total</strong> wellhead gas:liquid ratio, inclusive of injection gas, in scf/bbl</li><li><code>APIoil</code>: API gravity of the produced oil</li><li><code>sg_water</code>: specific gravity of produced water</li><li><code>sg_gas</code>: specific gravity of produced gas</li></ul><p><strong>Optional</strong></p><ul><li><code>injection_point = missing</code>: injection point in MD for gas lift, above which total GLR is used, and below which natural GLR is used</li><li><code>naturalGLR = missing</code>: GLR to use below point of injection, in scf/bbl</li><li>`pressurecorrelation::Function = BeggsAndBrill: pressure correlation to use</li><li><code>error_tolerance = 0.1</code>: error tolerance for each segment in psi</li><li><code>molFracCO2 = 0.0</code>, <code>molFracH2S = 0.0</code>: produced gas fractions of hydrogen sulfide and CO2, [0,1]</li><li><code>pseudocrit_pressure_correlation::Function = HankinsonWithWichertPseudoCriticalPressure</code>: psuedocritical pressure function to use</li><li><code>pseudocrit_temp_correlation::Function = HankinsonWithWichertPseudoCriticalTemp</code>: pseudocritical temperature function to use</li><li><code>Z_correlation::Function = KareemEtAlZFactor</code>: natural gas compressibility/Z-factor correlation to use</li><li><code>gas_viscosity_correlation::Function = LeeGasViscosity</code>: gas viscosity correlation to use</li><li><code>solutionGORcorrelation::Function = StandingSolutionGOR</code>: solution GOR correlation to use</li><li><code>bubblepoint::Union{Function, Real} = StandingBubblePoint</code>: either bubble point correlation or bubble point in <strong>psia</strong></li><li><code>oilVolumeFactor_correlation::Function = StandingOilVolumeFactor</code>: oil volume factor correlation to use</li><li><code>waterVolumeFactor_correlation::Function = GouldWaterVolumeFactor</code>: water volume factor correlation to use</li><li><code>dead_oil_viscosity_correlation::Function = GlasoDeadOilViscosity</code>: dead oil viscosity correlation to use</li><li><code>live_oil_viscosity_correlation::Function = ChewAndConnallySaturatedOilViscosity</code>: saturated oil viscosity correction function to use</li><li><code>frictionfactor::Function = SerghideFrictionFactor</code>: correlation function for Darcy-Weisbach friction factor</li><li><code>outlet_referenced = true</code>: whether to use outlet pressure (WHP) or inlet pressure (BHP) for</li></ul></div></div><a class="source-link" target="_blank" href="https://github.com/jnoynaert/PressureDrop.jl/blob/7fd8bf2c10af78a06320ebbb189e9e2a903cb140/src/types.jl#L137-L184">source</a></section><h3><a class="nav-anchor" id="Functions-1" href="#Functions-1">Functions</a></h3><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="PressureDrop.traverse_topdown" href="#PressureDrop.traverse_topdown"><code>PressureDrop.traverse_topdown</code></a> — <span class="docstring-category">Function</span>.</div><div><div><p><code>traverse_topdown(;&lt;named arguments&gt;)</code></p><p>Develop pressure traverse from wellhead down to datum in psia, returning a pressure profile as an Array{Float64,1}.</p><p>Pressure correlation functions available:</p><ul><li><code>BeggsAndBrill</code> with Payne correction factors</li><li><code>HagedornAndBrown</code> with Griffith and Wallis bubble flow correction</li></ul><p><strong>Arguments</strong></p><p>All arguments are named keyword arguments.</p><p><strong>Required</strong></p><ul><li><code>wellbore::Wellbore</code>: Wellbore object that defines segmentation/mesh, with md, tvd, inclination, and hydraulic diameter</li><li><code>roughness</code>: pipe wall roughness in inches</li><li><code>temperatureprofile::Array{Float64, 1}</code>: temperature profile (in °F) as an array with <strong>matching entries for each pipe segment defined in the Wellbore input</strong></li><li><code>WHP</code>: outlet pressure (wellhead pressure) in <strong>psig</strong></li><li><code>dp_est</code>: estimated starting pressure differential (in psi) to use for all segments–impacts convergence time</li><li><code>q_o</code>: oil rate in stocktank barrels/day</li><li><code>q_w</code>: water rate in stb/d</li><li><code>GLR</code>: <strong>total</strong> wellhead gas:liquid ratio, inclusive of injection gas, in scf/bbl</li><li><code>APIoil</code>: API gravity of the produced oil</li><li><code>sg_water</code>: specific gravity of produced water</li><li><code>sg_gas</code>: specific gravity of produced gas</li></ul><p><strong>Optional</strong></p><ul><li><code>injection_point = missing</code>: injection point in MD for gas lift, above which total GLR is used, and below which natural GLR is used</li><li><code>naturalGLR = missing</code>: GLR to use below point of injection, in scf/bbl</li><li>`pressurecorrelation::Function = BeggsAndBrill: pressure correlation to use</li><li><code>error_tolerance = 0.1</code>: error tolerance for each segment in psi</li><li><code>molFracCO2 = 0.0</code>, <code>molFracH2S = 0.0</code>: produced gas fractions of hydrogen sulfide and CO2, [0,1]</li><li><code>pseudocrit_pressure_correlation::Function = HankinsonWithWichertPseudoCriticalPressure</code>: psuedocritical pressure function to use</li><li><code>pseudocrit_temp_correlation::Function = HankinsonWithWichertPseudoCriticalTemp</code>: pseudocritical temperature function to use</li><li><code>Z_correlation::Function = KareemEtAlZFactor</code>: natural gas compressibility/Z-factor correlation to use</li><li><code>gas_viscosity_correlation::Function = LeeGasViscosity</code>: gas viscosity correlation to use</li><li><code>solutionGORcorrelation::Function = StandingSolutionGOR</code>: solution GOR correlation to use</li><li><code>bubblepoint::Union{Function, Real} = StandingBubblePoint</code>: either bubble point correlation or bubble point in <strong>psia</strong></li><li><code>oilVolumeFactor_correlation::Function = StandingOilVolumeFactor</code>: oil volume factor correlation to use</li><li><code>waterVolumeFactor_correlation::Function = GouldWaterVolumeFactor</code>: water volume factor correlation to use</li><li><code>dead_oil_viscosity_correlation::Function = GlasoDeadOilViscosity</code>: dead oil viscosity correlation to use</li><li><code>live_oil_viscosity_correlation::Function = ChewAndConnallySaturatedOilViscosity</code>: saturated oil viscosity correction function to use</li><li><code>frictionfactor::Function = SerghideFrictionFactor</code>: correlation function for Darcy-Weisbach friction factor</li></ul></div></div><a class="source-link" target="_blank" href="https://github.com/jnoynaert/PressureDrop.jl/blob/7fd8bf2c10af78a06320ebbb189e9e2a903cb140/src/PressureDrop.jl#L121-L164">source</a><div><div><p><code>traverse_topdown(;model::WellModel)</code></p><p>calculate top-down traverse from a WellModel object. Requires the following fields to be defined in the model:</p><p>...</p></div></div><a class="source-link" target="_blank" href="https://github.com/jnoynaert/PressureDrop.jl/blob/7fd8bf2c10af78a06320ebbb189e9e2a903cb140/src/PressureDrop.jl#L237-L243">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="PressureDrop.casing_traverse_topdown" href="#PressureDrop.casing_traverse_topdown"><code>PressureDrop.casing_traverse_topdown</code></a> — <span class="docstring-category">Function</span>.</div><div><div><p><code>casing_traverse_topdown(;&lt;named arguments&gt;)</code></p><p>Develops pressure traverse from casing head down to datum in psia, returning a pressure profile as an Array{Float64,1}.</p><p>Uses only density and is only applicable to pure gas injection, i.e. assumes no friction loss and no liquid entrained in gas stream (reasonable assumptions for relatively dry gas taken through several compression stages and injected through relatively large casing).</p><p>Pressure inputs are in <strong>psig</strong>.</p><p><strong>Arguments</strong></p><p>All arguments are named keyword arguments.</p><p><strong>Required</strong></p><ul><li><code>wellbore::Wellbore</code>: Wellbore object that defines segmentation/mesh, with md, tvd, inclination, and hydraulic diameter</li><li><code>temperatureprofile::Array{Float64, 1}</code>: temperature profile (in °F) as an array with <strong>matching entries for each pipe segment defined in the Wellbore input</strong></li><li><code>CHP</code>: casing head pressure, i.e. absolute surface injection pressure in <strong>psig</strong></li><li><code>dp_est</code>: estimated starting pressure differential (in psi) to use for all segments–impacts convergence time</li><li><code>sg_gas</code>: specific gravity of produced gas</li></ul><p><strong>Optional</strong></p><ul><li><code>error_tolerance = 0.1</code>: error tolerance for each segment in psi</li><li><code>molFracCO2 = 0.0</code>, <code>molFracH2S = 0.0</code>: produced gas fractions of hydrogen sulfide and CO2, [0,1]</li><li><code>pseudocrit_pressure_correlation::Function = HankinsonWithWichertPseudoCriticalPressure</code>: psuedocritical pressure function to use</li><li><code>pseudocrit_temp_correlation::Function = HankinsonWithWichertPseudoCriticalTemp</code>: pseudocritical temperature function to use</li><li><code>Z_correlation::Function = KareemEtAlZFactor</code>: natural gas compressibility/Z-factor correlation to use</li></ul></div></div><a class="source-link" target="_blank" href="https://github.com/jnoynaert/PressureDrop.jl/blob/7fd8bf2c10af78a06320ebbb189e9e2a903cb140/src/casingcalculations.jl#L39-L65">source</a><div><div><p><code>casing_traverse_topdown(m::WellModel)</code></p><p>Remaps casing traverse to work with WellModels</p></div></div><a class="source-link" target="_blank" href="https://github.com/jnoynaert/PressureDrop.jl/blob/7fd8bf2c10af78a06320ebbb189e9e2a903cb140/src/casingcalculations.jl#L99-L103">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="PressureDrop.pressure_and_temp!" href="#PressureDrop.pressure_and_temp!"><code>PressureDrop.pressure_and_temp!</code></a> — <span class="docstring-category">Function</span>.</div><div><div><p><code>pressure_and_temp(;model::WellModel)</code></p><p>Develop pressure traverse in psia and temperature profile in °F from wellhead down to datum for a WellModel object. Requires the following fields to be defined in the model:</p><p>Returns a pressure profile as an Array{Float64,1} and updates the passed WellModel&#39;s temperature profile, referenced to the measured depths in the original Wellbore object.</p><p><strong>Arguments</strong></p><p>All arguments are defined in the model object; see the <code>WellModel</code> documentation for reference.</p><p>Pressure correlation functions available:</p><ul><li><code>BeggsAndBrill</code> with Payne correction factors</li><li><code>HagedornAndBrown</code> with Griffith and Wallis bubble flow correction</li></ul><p>Temperature methods available:</p><ul><li>&quot;Shiu&quot; to utilize the Ramey 1962 method with the Shiu 1980 relaxation factor correlation</li><li>&quot;linear&quot; for a linear interpolation between wellhead and bottomhole temperature based on TVD</li></ul><p><strong>Required <code>WellModel</code> fields</strong></p><ul><li><code>well::Wellbore</code>: Wellbore object that defines segmentation/mesh, with md, tvd, inclination, and hydraulic diameter</li><li><code>roughness</code>: pipe wall roughness in inches</li><li><code>temperature_method = &quot;linear&quot;</code>: temperature method to use; &quot;Shiu&quot; for Ramey method with Shiu relaxation factor, &quot;linear&quot; for linear interpolation</li><li><code>WHT = missing</code>: wellhead temperature in °F; required for <code>temperature_method = &quot;linear&quot;</code></li><li><code>geothermal_gradient = missing</code>: geothermal gradient in °F per 100 ft; required for <code>temperature_method = &quot;Shiu&quot;</code></li><li><code>BHT</code> = bottomhole temperature in °F</li><li><code>WHP</code>: absolute outlet pressure (wellhead pressure) in <strong>psig</strong></li><li><code>dp_est</code>: estimated starting pressure differential (in psi) to use for all segments–impacts convergence time</li><li><code>q_o</code>: oil rate in stocktank barrels/day</li><li><code>q_w</code>: water rate in stb/d</li><li><code>GLR</code>: <strong>total</strong> wellhead gas:liquid ratio, inclusive of injection gas, in scf/bbl</li><li><code>APIoil</code>: API gravity of the produced oil</li><li><code>sg_water</code>: specific gravity of produced water</li><li><code>sg_gas</code>: specific gravity of produced gas</li></ul><p><strong>Optional <code>WellModel</code> fields</strong></p><ul><li><code>injection_point = missing</code>: injection point in MD for gas lift, above which total GLR is used, and below which natural GLR is used</li><li><code>naturalGLR = missing</code>: GLR to use below point of injection, in scf/bbl</li><li>`pressurecorrelation::Function = BeggsAndBrill: pressure correlation to use</li><li><code>error_tolerance = 0.1</code>: error tolerance for each segment in psi</li><li><code>molFracCO2 = 0.0</code>, <code>molFracH2S = 0.0</code>: produced gas fractions of hydrogen sulfide and CO2, [0,1]</li><li><code>pseudocrit_pressure_correlation::Function = HankinsonWithWichertPseudoCriticalPressure</code>: psuedocritical pressure function to use</li><li><code>pseudocrit_temp_correlation::Function = HankinsonWithWichertPseudoCriticalTemp</code>: pseudocritical temperature function to use</li><li><code>Z_correlation::Function = KareemEtAlZFactor</code>: natural gas compressibility/Z-factor correlation to use</li><li><code>gas_viscosity_correlation::Function = LeeGasViscosity</code>: gas viscosity correlation to use</li><li><code>solutionGORcorrelation::Function = StandingSolutionGOR</code>: solution GOR correlation to use</li><li><code>bubblepoint::Union{Function, Real} = StandingBubblePoint</code>: either bubble point correlation or bubble point in <strong>psia</strong></li><li><code>oilVolumeFactor_correlation::Function = StandingOilVolumeFactor</code>: oil volume factor correlation to use</li><li><code>waterVolumeFactor_correlation::Function = GouldWaterVolumeFactor</code>: water volume factor correlation to use</li><li><code>dead_oil_viscosity_correlation::Function = GlasoDeadOilViscosity</code>: dead oil viscosity correlation to use</li><li><code>live_oil_viscosity_correlation::Function = ChewAndConnallySaturatedOilViscosity</code>: saturated oil viscosity correction function to use</li><li><code>frictionfactor::Function = SerghideFrictionFactor</code>: correlation function for Darcy-Weisbach friction factor</li><li><code>outlet_referenced = true</code>: whether to use outlet pressure (WHP) or inlet pressure (BHP) for starting point</li></ul></div></div><a class="source-link" target="_blank" href="https://github.com/jnoynaert/PressureDrop.jl/blob/7fd8bf2c10af78a06320ebbb189e9e2a903cb140/src/PressureDrop.jl#L261-L314">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="PressureDrop.pressures_and_temp!" href="#PressureDrop.pressures_and_temp!"><code>PressureDrop.pressures_and_temp!</code></a> — <span class="docstring-category">Function</span>.</div><div><div><p><code>pressures_and_temp!(m::WellModel)</code></p><p>Returns a tubing pressure profile as an Array{Float64,1}, casing pressure profile as an Array{Float64,1}, and updates the passed WellModel&#39;s temperature profile, referenced to the measured depths in the original Wellbore object.</p><p><strong>Arguments</strong></p><p>See <code>WellModel</code> documentation.</p></div></div><a class="source-link" target="_blank" href="https://github.com/jnoynaert/PressureDrop.jl/blob/7fd8bf2c10af78a06320ebbb189e9e2a903cb140/src/PressureDrop.jl#L334-L342">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="PressureDrop.gaslift_model!" href="#PressureDrop.gaslift_model!"><code>PressureDrop.gaslift_model!</code></a> — <span class="docstring-category">Function</span>.</div><div><div><p><code>gaslift_model!(m::WellModel; find_injectionpoint::Bool = false, dp_min = 100)</code></p><p>Returns a tubing pressure profile as an Array{Float64,1}, casing pressure profile as an Array{Float64,1}, valve data table, and updates the passed WellModel&#39;s temperature profile,</p><p><strong>Arguments</strong></p><p>See <code>WellModel</code> documentation.</p><ul><li><code>find_injectionpoint::Bool = false</code>: whether to automatically infer the injection point (taken as the lowest reasonable point of lift based on differential pressure)*</li><li><code>dp_min = 100</code>: minimum casing-tubing differential pressure at depth to infer an injection point</li></ul><p>*&quot;greedy opening&quot; heuristic: select <em>lowest</em> non-orifice valve where CP @ depth is within operating envelope (below opening pressure but still above closing pressure) and has greater than the indicated differential pressure (<code>dp_min</code>)</p></div></div><a class="source-link" target="_blank" href="https://github.com/jnoynaert/PressureDrop.jl/blob/7fd8bf2c10af78a06320ebbb189e9e2a903cb140/src/PressureDrop.jl#L352-L365">source</a></section><footer><hr/><a class="previous" href="../"><span class="direction">Previous</span><span class="title">Overview</span></a><a class="next" href="../plotting/"><span class="direction">Next</span><span class="title">Plotting</span></a></footer></article></body></html>
